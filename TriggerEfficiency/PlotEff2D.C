void PlotEff2D(void) {
  gStyle->SetCanvasBorderMode(0);
  gStyle->SetPadBorderMode(0);
  gStyle->SetDrawBorder(0);
  gStyle->SetOptStat(0);
  gStyle->SetPadColor(0);
  gStyle->SetCanvasColor(0);
  gStyle->SetTitleFillColor(0);
  gStyle->SetTitleBorderSize(0);

  const int nmh = 7;
  const int nctau = 12;
  const int ntrigs = 5;
  // efficiency vs. mh and ctau, mx = 20
  float eff_all[nmh][nctau][ntrigs] = {
    // mH=100
    {
      {9.9, 67.6, 0.4, 2.9, 0.4}, // ctau=50
      {10.4, 71.8, 0.5, 3.1, 0.5}, // ctau=100
      {8.9, 70.4, 0.4, 2.5, 0.3}, // ctau=150
      {9.3, 68.5, 0.3, 3.0, 0.2}, // ctau=200
      {7.6, 69.2, 0.1, 3.8, 0.1}, // ctau=250
      {6.6, 64.2, 0.1, 2.3, 0.1}, // ctau=300
      {6.2, 64.9, 0.3, 2.5, 0.3}, // ctau=350
      {7.8, 62.7, 0.0, 4.1, 0}, // ctau=400
      {6.9, 60.9, 0.0, 1.8, 0}, // ctau=450
      {5.5, 61.5, 0.3, 2.6, 0.3}, // ctau=500
      {5.7, 57.6, 0.3, 3.9, 0.1}, // ctau=550
      {5.7, 57.2, 0.4, 3.4, 0.3}, // ctau=600
    },
    // mH=125
    {
      {15.7, 85.7, 1.6, 4.4, 1.3}, // ctau=50
      {15.3, 85.7, 0.9, 4.3, 0.8}, // ctau=100
      {16.3, 84.1, 1.6, 5.3, 1.3}, // ctau=150
      {11.5, 81.0, 0.4, 4.8, 0.3}, // ctau=200
      {13.2, 79.1, 0.3, 5.7, 0.3}, // ctau=250
      {11.4, 77.1, 0.6, 5.2, 0.4}, // ctau=300
      {8.6, 71.4, 0.1, 4.1, 0.1}, // ctau=350
      {9.2, 73.7, 0.2, 4.9, 0.2}, // ctau=400
      {10.4, 72.3, 0.0, 6.4, 0}, // ctau=450
      {6.8, 68.1, 0.3, 4.5, 0.3}, // ctau=500
      {8.3, 68.1, 0.5, 4.9, 0.5}, // ctau=550
      {8.0, 67.8, 0.0, 4.5, 0}, // ctau=600
    },
    // mH=200
    {
      {33.8, 96.9, 4.4, 10.6, 3.4}, // ctau=50
      {31.3, 94.6, 3.3, 10.3, 2.4}, // ctau=100
      {28.2, 94.7, 2.5, 12.5, 2.4}, // ctau=150
      {24.1, 90.0, 1.8, 11.7, 1.4}, // ctau=200
      {22.4, 88.1, 1.9, 12.6, 1.6}, // ctau=250
      {21.4, 86.8, 1.2, 14.0, 1.1}, // ctau=300
      {16.9, 83.0, 1.1, 13.3, 1.0}, // ctau=350
      {17.2, 82.7, 1.0, 12.6, 0.9}, // ctau=400
      {18.6, 81.4, 1.4, 15.9, 1.1}, // ctau=450
      {17.2, 78.3, 0.5, 13.0, 0.4}, // ctau=500
      {14.9, 77.6, 0.9, 13.3, 0.6}, // ctau=550
      {15.0, 75.2, 0.7, 13.4, 0.6}, // ctau=600
    },
    // mH=250
    {
      {54.2, 97.5, 10.3, 17.5, 9.3}, // ctau=50
      {48.7, 96.1, 7.3, 20.6, 6.4}, // ctau=100
      {44.1, 94.7, 7.3, 23.6, 6.0}, // ctau=150
      {35.2, 93.1, 5.2, 24.6, 4.6}, // ctau=200
      {35.1, 89.9, 4.2, 25.1, 3.9}, // ctau=250
      {28.0, 87.1, 2.9, 22.5, 2.4}, // ctau=300
      {25.9, 85.1, 2.8, 25.2, 2.3}, // ctau=350
      {26.0, 82.5, 2.8, 25.2, 2.7}, // ctau=400
      {20.8, 79.6, 1.3, 21.1, 0.8}, // ctau=450
      {20.1, 79.4, 1.6, 21.3, 1.4}, // ctau=500
      {19.5, 80.0, 1.3, 23.3, 1.1}, // ctau=550
      {21.6, 76.8, 1.7, 22.4, 1.5}, // ctau=600
    },
    // mH=300
    {
      {72.1, 98.8, 22.8, 36.8, 20.8}, // ctau=50
      {61.3, 97.6, 16.9, 36.3, 15.9}, // ctau=100
      {49.2, 94.8, 11.8, 39.6, 11.2}, // ctau=150
      {41.8, 92.7, 10.6, 40.0, 10.0}, // ctau=200
      {34.9, 88.1, 7.5, 36.3, 7.0}, // ctau=250
      {31.8, 84.2, 5.4, 33.0, 4.9}, // ctau=300
      {28.7, 83.6, 5.1, 33.9, 4.9}, // ctau=350
      {28.0, 83.3, 4.4, 34.3, 3.9}, // ctau=400
      {24.7, 81.3, 3.7, 31.4, 3.1}, // ctau=450
      {24.7, 80.2, 2.7, 30.7, 2.4}, // ctau=500
      {25.5, 78.9, 3.4, 30.7, 3.3}, // ctau=550
      {23.1, 76.1, 2.6, 29.0, 2.1}, // ctau=600
    },
    // mH=350
    {
      {77.3, 98.9, 34.0, 51.2, 31.9}, // ctau=50
      {63.2, 97.0, 22.7, 54.2, 21.5}, // ctau=100
      {51.7, 94.6, 17.7, 52.2, 16.2}, // ctau=150
      {45.4, 90.2, 13.1, 50.1, 12.3}, // ctau=200
      {42.8, 88.3, 10.2, 49.0, 9.9}, // ctau=250
      {38.8, 85.4, 9.1, 47.5, 8.6}, // ctau=300
      {36.0, 83.4, 6.8, 45.2, 6.5}, // ctau=350
      {29.3, 79.9, 4.7, 41.2, 3.7}, // ctau=400
      {31.6, 79.3, 5.4, 41.5, 5.0}, // ctau=450
      {30.0, 77.5, 4.5, 39.8, 4.4}, // ctau=500
      {29.4, 78.9, 4.0, 39.6, 3.7}, // ctau=550
      {30.4, 79.9, 4.6, 39.0, 4.2}, // ctau=600
    },
    // mH=400
    {
      {81.1, 99.5, 39.2, 57.3, 36.7}, // ctau=50
      {65.6, 96.8, 26.4, 64.6, 24.9}, // ctau=100
      {59.4, 94.2, 18.2, 62.3, 17.7}, // ctau=150
      {50.0, 90.2, 11.7, 56.5, 10.8}, // ctau=200
      {45.9, 86.9, 9.2, 53.9, 8.5}, // ctau=250
      {44.5, 84.4, 9.3, 50.2, 8.7}, // ctau=300
      {39.6, 82.0, 6.5, 49.4, 6.0}, // ctau=350
      {39.4, 80.7, 6.9, 48.4, 6.0}, // ctau=400
      {33.5, 80.3, 3.6, 45.9, 3.5}, // ctau=450
      {35.1, 79.1, 4.9, 46.3, 4.7}, // ctau=500
      {33.5, 77.2, 4.9, 46.5, 4.7}, // ctau=550
      {33.3, 80.1, 2.9, 43.7, 2.9}, // ctau=600
    },

  };
  // uncertainty on efficiency
  float efferr_all[nmh][nctau][ntrigs] = {
    // mH=100
    {
      {0.9, 1.5, 0.2, 0.5, 0.2}, // ctau=50
      {1.0, 1.4, 0.2, 0.5, 0.2}, // ctau=100
      {0.9, 1.4, 0.2, 0.5, 0.2}, // ctau=150
      {0.9, 1.5, 0.2, 0.5, 0.1}, // ctau=200
      {0.8, 1.5, 0.1, 0.6, 0.1}, // ctau=250
      {0.8, 1.5, 0.1, 0.5, 0.1}, // ctau=300
      {0.8, 1.5, 0.2, 0.5, 0.2}, // ctau=350
      {0.8, 1.5, 0.0, 0.6, 0}, // ctau=400
      {0.8, 1.5, 0.0, 0.4, 0}, // ctau=450
      {0.7, 1.5, 0.2, 0.5, 0.2}, // ctau=500
      {0.7, 1.6, 0.2, 0.6, 0.1}, // ctau=550
      {0.7, 1.6, 0.2, 0.6, 0.2}, // ctau=600
    },
    // mH=125
    {
      {1.2, 1.1, 0.4, 0.6, 0.4}, // ctau=50
      {1.1, 1.1, 0.3, 0.6, 0.3}, // ctau=100
      {1.2, 1.2, 0.4, 0.7, 0.4}, // ctau=150
      {1.0, 1.2, 0.2, 0.7, 0.2}, // ctau=200
      {1.1, 1.3, 0.2, 0.7, 0.2}, // ctau=250
      {1.0, 1.3, 0.2, 0.7, 0.2}, // ctau=300
      {0.9, 1.4, 0.1, 0.6, 0.1}, // ctau=350
      {0.9, 1.4, 0.1, 0.7, 0.1}, // ctau=400
      {1.0, 1.4, 0.0, 0.8, 0}, // ctau=450
      {0.8, 1.5, 0.2, 0.7, 0.2}, // ctau=500
      {0.9, 1.5, 0.2, 0.7, 0.2}, // ctau=550
      {0.9, 1.5, 0.0, 0.7, 0}, // ctau=600
    },
    // mH=200
    {
      {1.5, 0.5, 0.6, 1.0, 0.6}, // ctau=50
      {1.5, 0.7, 0.6, 1.0, 0.5}, // ctau=100
      {1.4, 0.7, 0.5, 1.0, 0.5}, // ctau=150
      {1.4, 0.9, 0.4, 1.0, 0.4}, // ctau=200
      {1.3, 1.0, 0.4, 1.0, 0.4}, // ctau=250
      {1.3, 1.1, 0.3, 1.1, 0.3}, // ctau=300
      {1.2, 1.2, 0.3, 1.1, 0.3}, // ctau=350
      {1.2, 1.2, 0.3, 1.0, 0.3}, // ctau=400
      {1.2, 1.2, 0.4, 1.2, 0.3}, // ctau=450
      {1.2, 1.3, 0.2, 1.1, 0.2}, // ctau=500
      {1.1, 1.3, 0.3, 1.1, 0.2}, // ctau=550
      {1.1, 1.4, 0.3, 1.1, 0.2}, // ctau=600
    },
    // mH=250
    {
      {1.6, 0.5, 1.0, 1.2, 0.9}, // ctau=50
      {1.6, 0.6, 0.8, 1.3, 0.8}, // ctau=100
      {1.6, 0.7, 0.8, 1.3, 0.8}, // ctau=150
      {1.5, 0.8, 0.7, 1.4, 0.7}, // ctau=200
      {1.5, 1.0, 0.6, 1.4, 0.6}, // ctau=250
      {1.4, 1.1, 0.5, 1.3, 0.5}, // ctau=300
      {1.4, 1.1, 0.5, 1.4, 0.5}, // ctau=350
      {1.4, 1.2, 0.5, 1.4, 0.5}, // ctau=400
      {1.3, 1.3, 0.4, 1.3, 0.3}, // ctau=450
      {1.3, 1.3, 0.4, 1.3, 0.4}, // ctau=500
      {1.3, 1.3, 0.4, 1.3, 0.3}, // ctau=550
      {1.3, 1.3, 0.4, 1.3, 0.4}, // ctau=600
    },
    // mH=300
    {
      {1.4, 0.3, 1.3, 1.5, 1.3}, // ctau=50
      {1.5, 0.5, 1.2, 1.5, 1.2}, // ctau=100
      {1.6, 0.7, 1.0, 1.5, 1.0}, // ctau=150
      {1.6, 0.8, 1.0, 1.5, 0.9}, // ctau=200
      {1.5, 1.0, 0.8, 1.5, 0.8}, // ctau=250
      {1.5, 1.2, 0.7, 1.5, 0.7}, // ctau=300
      {1.4, 1.2, 0.7, 1.5, 0.7}, // ctau=350
      {1.4, 1.2, 0.6, 1.5, 0.6}, // ctau=400
      {1.4, 1.2, 0.6, 1.5, 0.5}, // ctau=450
      {1.4, 1.3, 0.5, 1.5, 0.5}, // ctau=500
      {1.4, 1.3, 0.6, 1.5, 0.6}, // ctau=550
      {1.3, 1.3, 0.5, 1.4, 0.5}, // ctau=600
    },
    // mH=350
    {
      {1.3, 0.3, 1.5, 1.6, 1.5}, // ctau=50
      {1.5, 0.5, 1.3, 1.6, 1.3}, // ctau=100
      {1.6, 0.7, 1.2, 1.6, 1.2}, // ctau=150
      {1.6, 0.9, 1.1, 1.6, 1.0}, // ctau=200
      {1.6, 1.0, 1.0, 1.6, 0.9}, // ctau=250
      {1.5, 1.1, 0.9, 1.6, 0.9}, // ctau=300
      {1.5, 1.2, 0.8, 1.6, 0.8}, // ctau=350
      {1.4, 1.3, 0.7, 1.6, 0.6}, // ctau=400
      {1.5, 1.3, 0.7, 1.6, 0.7}, // ctau=450
      {1.4, 1.3, 0.7, 1.5, 0.6}, // ctau=500
      {1.4, 1.3, 0.6, 1.5, 0.6}, // ctau=550
      {1.5, 1.3, 0.7, 1.5, 0.6}, // ctau=600
    },
    // mH=400
    {
      {1.2, 0.2, 1.5, 1.6, 1.5}, // ctau=50
      {1.5, 0.6, 1.4, 1.5, 1.4}, // ctau=100
      {1.6, 0.8, 1.3, 1.6, 1.3}, // ctau=150
      {1.6, 0.9, 1.0, 1.6, 1.0}, // ctau=200
      {1.6, 1.1, 0.9, 1.6, 0.9}, // ctau=250
      {1.6, 1.1, 0.9, 1.6, 0.9}, // ctau=300
      {1.5, 1.2, 0.8, 1.6, 0.8}, // ctau=350
      {1.5, 1.2, 0.8, 1.6, 0.8}, // ctau=400
      {1.5, 1.3, 0.6, 1.6, 0.6}, // ctau=450
      {1.5, 1.3, 0.7, 1.6, 0.7}, // ctau=500
      {1.5, 1.3, 0.7, 1.6, 0.7}, // ctau=550
      {1.5, 1.3, 0.5, 1.6, 0.5}, // ctau=600
    },

  };
  
  const char *ctlabel[nctau] = {"50", "100", "150", "200", "250", "300",
				"350", "400", "450", "500", "550", "600"};
  const char *mhlabel[nmh] = {"100", "125", "200", "250", "300", "350", "400"};

  
  TH2F *h[ntrigs];
  const char *trignames[ntrigs] = {"Any displaced L1",
				   "Any L1",
				   "Any displaced HLT",
				   "Any HLT",
				   "Best single HLT"};

  char buf[512];
  for (int i=0; i<ntrigs; i++) {
    sprintf(buf, "h%d", i);
    h[i] = new TH2F(buf, trignames[i], nctau, -0.5, (float)nctau-0.5,
		    nmh, -0.5, (float)nmh-0.5);
    for (int j=0; j<nctau; j++)
      h[i]->GetXaxis()->SetBinLabel(j+1, ctlabel[j]);
    for (int j=0; j<nmh; j++)
      h[i]->GetYaxis()->SetBinLabel(j+1, mhlabel[j]);
  };
    
  const int colors[ntrigs] = {kBlack, kBlack, kBlue, kBlue, kBlue};
  const int markers[ntrigs] = {kOpenCircle, kOpenCircle, kFullCircle, kFullCircle, kFullSquare};

  for (int i=0; i<ntrigs; i++) {
    h[i]->SetLineColor(colors[i]);
    h[i]->SetMarkerColor(colors[i]);
    h[i]->SetMarkerStyle(markers[i]);
  }

  for (int i=0; i<nmh; i++) {
    for (int j=0; j<nctau; j++) {
      for (int k=0; k<ntrigs; k++) {
	h[k]->Fill(j, i, eff_all[i][j][k]);
	h[k]->SetBinError(h[k]->GetBin(j+1, i+1), efferr_all[i][j][k]);
      }
    }
  }

  for (int i=0; i<ntrigs; i++) {
    h[i]->SetMinimum(0);
    h[i]->SetMaximum(100);
  }

  c1 = new TCanvas("c1", "Efficiencies", 1000, 500);
  c1->Divide(2,1);
  c1->cd(1);
  gPad->SetLeftMargin(0.12);
  h[1]->SetTitle("Any L1 and HLT efficiency vs. c#tau and m_{H}, m_{X} = 20");
  h[1]->GetXaxis()->SetTitle("c#tau of sample (mm)");
  h[1]->GetXaxis()->SetTitleColor(kBlack);
  h[1]->GetYaxis()->SetTitle("m_{H} (GeV/c^{2})");
  h[1]->GetYaxis()->SetTitleOffset(1.23);
  h[1]->GetZaxis()->SetTitle("Trigger efficiency (%)");
  h[1]->GetZaxis()->SetTitleOffset(1.3);
  h[1]->DrawCopy("surf");
  h[3]->DrawCopy("surf same");
  
  c1->cd(2);
  h[0]->SetTitle("Displaced L1 and HLT efficiency vs. c#tau and m_{H}, m_{X} = 20");
  h[0]->GetXaxis()->SetTitle("c#tau of sample (mm)");
  h[0]->GetXaxis()->SetTitleColor(kBlack);
  h[0]->GetYaxis()->SetTitle("m_{H} (GeV/c^{2})");
  h[0]->GetYaxis()->SetTitleOffset(1.23);
  h[0]->GetZaxis()->SetTitle("Trigger efficiency (%)");
  h[0]->GetZaxis()->SetTitleOffset(1.3);
  h[0]->DrawCopy("surf");
  h[2]->DrawCopy("surf same");

//   TLegend *l = new TLegend(0.50, 0.37, 0.88, 0.48);
//   l->SetFillColor(0);
//   l->SetBorderSize(0);
//   for (int i=6; i<ntrigs; i++) {
//     l->AddEntry(h[i], trignames[i]);
//   }
//   l->Draw();

  c1->Print("TriggerEff2D.png");

  c2 = new TCanvas("c2", "Efficiencies", 1000, 500);
  c2->Divide(2,1);
  c2->cd(1);
  gPad->SetLeftMargin(0.12);
  h[1]->SetTitle("Efficiency vs. c#tau and m_{H}, m_{X} = 20");
  h[1]->DrawCopy("surf");
  h[2]->DrawCopy("surf same");

  c2->cd(2);
  gPad->SetLeftMargin(0.12);
  h[1]->Draw("surf");
  h[4]->Draw("surf same");

  c2->Print("TriggerEff2D2.png");
}
